(CNN)A loophole that vaping companies have used to circumvent regulators and keep their products on shelves closed this week, enabling the US Food and Drug Administration to go after myriad products being marketed illegally and in a variety of flavors.  In order to avoid FDA oversight, companies have been making synthetic nicotine in the lab -- and not derived from tobacco and thus within the agency's purview. But the national spending bill enacted March 15 "makes clear that FDA can regulate tobacco products containing nicotine from any source," the agency said Wednesday, the day before the law finally took effect.  Now, anyone who makes or sells "non-tobacco nicotine" must comply with FDA regulations, which also include not selling to people under 21, not giving away free samples, and not making claims that their products are less harmful than cigarettes without FDA authorization.  Companies that make these products must also register them with the agency and submit a "premarket application" by May 14 in order to stay on the market legally. This review includes looking at their marketing and youth uptake, for example.  By the end of January, over 6.6 million products had been successfully submitted to the agency, nearly all of which were e-cigarette products. Only a small handful were authorized to stay on the market, and over 1.2 million have been rejected while others sit in regulatory limbo.  Last week, FDA leaders authored an opinion in The Hill, describing how vaping companies would switch up their nicotine source after being issued warnings by the FDA. Now those companies "will be held to the same public health standards we've worked so hard to implement for other tobacco products," they wrote.  Among the products newly facing FDA oversight is a disposable brand known as Puff Bar, which comes in a variety of flavors and was the most popular among students in 2021. More than a quarter of high schoolers who currently vaped said that Puff Bar was their usual brand. CNN has reached out to Puff Bar for comment.  