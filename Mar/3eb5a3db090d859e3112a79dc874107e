London (CNN Business)In the weeks since Russia invaded Ukraine, Moscow has continued to ship natural gas westward and Europe has used the energy to power industry and heat homes. That may be about to change. President Vladimir Putin has demanded that "unfriendly" countries start paying for natural gas with rubles rather than US dollars or euros, as agreed in their supply contracts. Germany, Russia's biggest energy customer in Europe, has dismissed Putin's directive as "blackmail." "A payment with rubles is not acceptable," German economy minister Robert Habeck said Monday, adding that "we will not be divided and the answer of the G7 states is unambiguous: the contracts will be met." The payment spat threatens gas supplies that have continued to flow even as Russian troops shelled major cities in Ukraine and the West imposed crippling sanctions on Russia's economy. The European Union is now scrambling to replace Russian gas with other sources but by its own admission can't break its energy dependence before 2027. Putin has given Russia's central bank and Gazprom, the state gas company, until Thursday to come up with proposals for accepting payments in rubles. Ivan Abramov, a senior Russian lawmaker, said Monday that Moscow will halt gas shipments unless it receives payment in rubles, according to Reuters.  Major energy companies are likely to consider any requirement to change payment conditions a breach of contract. They'll be backed by Western governments that want to turn up the economic pressure on Putin. "It's unclear how Western countries will be able to access sufficient rubles to fund gas imports, or even whether they'd be willing to pay in rubles," said Liam Peach, emerging Europe economist at Capital Economics. "The measures taken by Russia may also be interpreted as provocative and may increase the possibility that Western nations tighten sanctions on Russian energy," he added. Putin's plan Why does Putin want energy companies to pay for Russian gas in rubles? The answer may be linked with the currency itself, which plunged to record lows against the US dollar after sanctions cut off Moscow from overseas reserves worth hundreds of billions of dollars. Since then, Russian officials have sought to support the currency by preventing investors and companies from selling the ruble. At the same time, they're trying to drum up demand for the currency. Demanding gas payments in rubles appears "to be an effort by the Russian authorities to apply pressure on Western countries by forcing foreign buyers of Russian gas to use rubles, with the added benefit of supporting the value of the currency," said Peach.  The European Union is planning to slash consumption of Russian natural gas this year as it prepares for a complete break with its single biggest energy supplier. But Europe would struggle to survive for long without Russian gas, and finding alternative sources presents a huge logistical challenge. A recession would be all but assured if Putin cuts off supplies. Still, the West is loathe to do anything to advance Putin's war effort. With the sanctioned Russian central bank banned from swapping euros and dollars for rubles, Moscow is trying to find a new stream of cash it can spend easily. Putin could "directly finance the war, the army, the supply of the soldiers, the supply of gasoline for the tanks and the construction of weapons in his own country" with rubles, Habeck said Monday. "What he cannot do is to exchange foreign currency with other countries," he added. Risky move Demanding gas payments in rubles may help boost the currency. But that doesn't mean it will be good for Russia over the long run. The move could hasten the demise of its huge energy sector. "Gas supply agreements are generally considered sacrosanct, and in an extreme scenario, insisting on ruble payments may give buyers cause to reopen other aspects of their contracts — such as the duration — and simply speed up their exit from Russian gas altogether," said Rystad Energy senior analyst Vinicius Romano. Another problem: Russian gas sales to Europe are worth up to $40 billion a year, and getting paid in rubles means the country will go without a major source of foreign currency at a time when its exports are plunging. That means Russia might not have enough foreign cash to pay for imports, forcing the country to turn inward and further isolate itself from the global economy. "The longer-term implication is that is accelerates Russia's strategy of de-dollarisation and reinforces the idea that Russia will continue to drift towards autarky," said Peach. — Nathan Hodge and Inke Kappeler contributed reporting. 