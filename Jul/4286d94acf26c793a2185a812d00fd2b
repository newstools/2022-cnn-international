(CNN Business)Microsoft's business is taking a hit from events on the other side of the world. The tech giant on Tuesday attributed lower-than-expected earnings to developments in China and Russia, including the former's extended Covid lockdowns and the latter's war against Ukraine. Microsoft (MSFT) recorded $51.9 billion in revenue and $16.7 billion in profit, up 12% and 2%, respectively, from the same period last year but lower than forecasts from analysts surveyed by Refinitiv. "Extended production shutdowns in China" resulted in a $300 million hit, the company said in its earnings release, adding that it spent $126 million to "significantly scale down" its operations in Russia because of the war in Ukraine. There were also more universal issues, however. Microsoft's jobs platform LinkedIn suffered from a reduction in advertising spend, along with Microsoft's search and news business, that resulted in a revenue decline of over $100 million. Amid the broader tech industry downturn, Microsoft said it undertook a "a strategic realignment" of its business that resulted in $113 million spent on employee severance (excluding Russia). Microsoft stock dipped around 1% lower in after-hours trading. There were some bright spots, however â€” foremost among them Microsoft's cloud business. The company's cloud revenue for the quarter was $25 billion, a 28% increase from the same quarter last year. "In a dynamic environment we saw strong demand, took share, and increased customer commitment to our cloud platform," Microsoft's executive vice president and chief financial officer Amy Hood said in a statement. Haris Anwar, a senior analyst at Investing.com, said the cloud growth reflected Microsoft's continued durability. "Today's results are very much reflecting the impact of a challenging economic environment which is hurting almost every mega tech company," he said in a statement. But the strong cloud performance indicates that "large and small companies continue to spend on their IT infrastructure, a trend which will continue to support Microsoft even if the economy slips into a recession," he added. 