Madrid (CNN)President Joe Biden was meeting royalty in Spain on Tuesday when word arrived that an audacious plan he had hatched six months earlier was in the final stages of completion. The leaders of Finland and Sweden were meeting across town in a conference room with the leader of Turkey, who for weeks had thrown up roadblocks to their accession to NATO. The group had reached a breakthrough. But they wanted a gut check to ensure Biden approved. Leaving his meeting with King Felipe VI at the Royal Palace, Biden took the call from Finland's President Sauli Niinistö and Sweden's Prime Minister Magdalena Andersson. They walked him through what they'd agreed to with President Recep Tayyip Erdoğan of Turkey. And he gave the sign-off. In the six-and-a-half months since Biden placed his first phone call to Niinistö suggesting he join NATO, the security situation in Europe has been altered drastically. Russia's invasion of Ukraine has thrown out long-standing assumptions about the security of nations along its borders. And countries that had for decades upheld a strict neutrality policy are suddenly reconsidering their stance. The efforts to bring Finland and Sweden into NATO were both the work of months of steady diplomacy and, over the past days, an intensive flurry of phone calls and meetings between top officials. The process was described by senior US and European officials. Heading into this week's summit, few of those officials believed the issues blocking the two Scandinavian countries' accession would be resolved by the time leaders departed Madrid. Instead, they had resigned themselves to making progress on an issue they believed could extend months longer. Instead, a marathon set of meetings, a strategically timed phone call from Biden to Erdoğan and a last-minute sign off resulted in the path being cleared for NATO's newest members. In the end, Biden dangled the prospect of a formal meeting with Erdoğan on the margins of this week's summit as he pushed to get the plan over the finish line. After Russia's invasion of Ukraine, it is clear why Finland and Sweden would consider abandoning their longtime security postures to join NATO. But in December, before Russian tanks began rolling into Ukraine, the prospect was more far-fetched. Still, on December 13, Biden placed a phone call to Niinistö to raise the idea. Russian President Vladimir Putin had been massing troops and equipment along Ukraine's borders. And it was clear to him the security situation in Europe was about to change dramatically. In March, after the invasion began, Biden invited Niinistö to the White House for talks. Sitting in the Oval Office and hashing out details of the proposal, the two men picked up the phone and called Andersson in Sweden -- where it was after dark -- to fill her in. In May, the two countries formally submitted their applications to join the NATO alliance. The next day, they were in the White House Rose Garden with Biden marking a historic milestone. "After 200 years of military non-alignment, Sweden has chosen a new path," Andersson said. "Finland has made its decision after a rapid but a very thorough process," Niinistö added. Clouding the Rose Garden celebrations, however, was firm resistance from Turkey at adding new members to the alliance. Long NATO's most challenging member, Erdoğan accused the nations of harboring members of the separatist militant Kurdistan's Workers Party, also known as PKK, which Turkey views as a terrorist organization. He also wanted the countries to get rid of an embargo on arms sales to Turkey that was put into place after Turkey's military intervention in northern Syria in 2019. The three countries continued talking. But in a conscious decision, Biden tried to keep his distance and avoid putting the United States in the middle. Instead, Biden "chose his moments selectively to try to help put a thumb on the scale to get this across the finish line," according to a senior administration official. "The Americans do not want to put themselves in the middle of this because the price then goes up," a European official said. "If the American (President) somehow indicate that this is that problem, (Erdoğan will) have a whole load of other things he wants to ask for." Still, talks continued among the different parties. National security adviser Jake Sullivan and Secretary of State Antony Blinken spoke with their Turkish counterparts. Finland and Sweden maintained their own talks with Turkey. And the talks slogged on. As the Madrid summit approached, US and European officials grew increasingly frustrated at Turkey's resistance, which some believed was being drawn out on purpose to extract concessions. Officials who once privately said they hoped the Madrid summit would act as a welcoming party for the alliance's two newest members came to believe the prospect was unlikely. "I am not sitting here today suggesting that all issues will be resolved by Madrid," Sullivan said on Monday -- a day ahead of Biden's arrival in Madrid. But as the summit neared, signs of progress emerged. And on Tuesday morning, Biden received a request from Niinistö and Andersson: The time was right for him to place a call to Erdoğan. Speaking from the Bavarian Alps, where he was attending the G7 summit, Biden encouraged the until-then recalcitrant Turkish leader to "seize the moment and get this done in Madrid," the administration official said. And he told him if the deal could be struck before the summit began, it would set the stage for a formal bilateral meeting between the two men in Spain. "It is Turkey's standard operating procedure not to give concessions till the last possible moment. And that last possible moment is usually defined as a bilateral with the US president," the European official said. The strategy proved effective. By the early evening, Niinistö, Andersson and Erdoğan were announcing that Turkey's objections had been dropped and Finland and Sweden's applications to join NATO would go ahead. And Biden will meet formally with Erdoğan on Wednesday. Turkey said it "got what it wanted" in the agreement, including cooperation on "extradition of terrorist criminals." The senior US administration official said there were "a bunch of moving parts" and not a "single word or phrase" that proved the final sticking point. Erdoğan's long-standing grievances toward the United States, including Washington's refusal to sell Turkey F-16 fighter jets and his demand the US extradite a cleric he accuses of cultivating a coup attempt, remain unresolved -- and are likely to arise in his meeting with Biden. Whatever the dispute once was, however, leaders framed the outcome as a triumph. And more than four months into the Russian war in Ukraine, NATO is poised to welcome two new members. "Congratulations to Finland, Sweden, and Turkey on signing a trilateral memorandum -- a crucial step towards a NATO invite to Finland and Sweden, which will strengthen our Alliance and bolster our collective security -- and a great way to begin the Summit," Biden wrote on Twitter. The image was from their May meeting as they walked into the Rose Garden. 