(CNN)Retired Marine Gen. John Allen resigned as president of the Brookings Institution on Sunday amid a federal investigation into whether he lobbied the US government on behalf of Qatar during the Trump administration. Allen, a retired four-star general who led US and allied troops in Afghanistan, wrote in his resignation letter, "While I leave the institution with a heavy heart, I know it is best for all concerned in this moment." Allen's resignation from Brookings, a prominent Washington think tank, comes after a court filing revealed last week, that is publicly available on a nonprofit legal research website, showed that the FBI had seized Allen's electronic communications. The FBI's search warrant in the court filing, which appeared to have been posted online by mistake, accused Allen of appearing to violate foreign lobbying laws and failing to provide emails related to the lobbying effort. Allen has denied lobbying on behalf of Qatar. The Associated Press first reported on the filing. The lobbying investigation concerns Allen's communications with Trump administration officials, including former national security adviser HR McMaster, after Qatar was diplomatically cut off by its Gulf rivals in 2017. The investigation is the latest effort by the Justice Department to crack down on foreign lobbying violations of the Foreign Agents Registration Act (FARA). In past statements, Allen spokesman Beau Phillips said the retired general's "efforts with regard to Qatar in 2017 were to protect the interests of the United States and the military personnel stationed in Qatar." Phillips added that Allen "received no fee for his efforts." The Brookings Institution in a statement Sunday thanked Allen for "his contributions to Brookings, including his leadership in successfully guiding the institution during the pandemic, as well as his many years of service and sacrifice for our country." The FBI's search warrant, which is dated in April, alleges that Allen was recruited in 2017 to travel to Qatar while the country was grappling with a blockade from other Gulf nations, which had accused Qatar of supporting extremism. Allen, who was a senior fellow at Brookings at the time, worked with businessman Imaad Zuberi, who pleaded guilty to violating foreign lobbying laws in 2019, and former US Ambassador to Pakistan and the United Arab Emirates Richard Olson, who pleaded guilty on foreign lobbying charges earlier this month. The trio traveled to Doha, Qatar, and Allen sought a "$20,000 'speaking engagement' fee," according to the court filling. Federal investigators noted that it's not clear whether Zuberi paid the fee or other compensation to Allen. Federal investigators allege in the search warrant that Allen adopted a "false version of events" in a 2020 FBI interview about why he was recruited to meet with Qatari officials. Investigators also accused Allen of failing to turn over emails under subpoena that were relevant to his work for Qatar. The warrant also alleges that Allen, Olson and Zuberi appeared to have violated foreign lobbying laws by trying to "influence US government officials on behalf of Qatar," without registering under FARA. Federal investigators alleged there was "substantial evidence that these FARA violations were willful." The search warrant included emails Allen sent from his Brookings email to McMaster in June 2017, writing that Qatar was looking for the White House or State Department to send a signal that would call for a peaceful resolution to the diplomatic crisis. Federal investigators wrote in the search warrant that McMaster said in a voluntary interview that Allen "did not disclose to him that he had been solicited by Zuberi and Olson, who were engaged in a lobbying and public relations campaign on behalf of Qatar." 