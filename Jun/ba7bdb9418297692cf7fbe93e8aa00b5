London (CNN)Britain's Queen Elizabeth II made a surprise appearance on the balcony of Buckingham Palace on Sunday, as part of the final day of celebrations to mark her historic 70-year reign. The Queen had skipped events on Friday and Saturday -- a thanksgiving service at St Paul's Cathedral and an afternoon at Epsom racecourse -- after experiencing "discomfort" during the opening day parade on Thursday. The Queen was flanked by three generations of her family -- Prince Charles and his wife, Camilla, the Duchess of Cornwall, as well as Prince William and Catherine, the Duchess of Cambridge, and their three children -- to the delight of thousands who had gathered along the Mall for the once-in-a-lifetime jubilee event. The crowd roared as the 96-year-old monarch -- dressed in a vibrant green and clutching her cane -- emerged with a broad smile and surveyed the patriotic sea of Union Jack flag-waving well-wishers before her. In a message released by Buckingham Palace on Saturday evening, the Queen said she had been "humbled and deeply touched" by all the people who had come together both at events in London and elsewhere in the United Kingdom to mark her  milestone. "When it comes to how to mark seventy years as your Queen, there is no guidebook to follow. It really is a first. But I have been humbled and deeply touched that so many people have taken to the streets to celebrate my Platinum Jubilee," the message began. "While I may not have attended every event in person, my heart has been with you all; and I remain committed to serving you to the best of my ability, supported by my family," she continued. The monarch said she had been "inspired by the kindness, joy and kinship" seen during the jubilee weekend and hoped "this renewed sense of togetherness will be felt for many years to come." She concluded her message, saying: "I thank you most sincerely for your good wishes and for the part you have all played in these happy celebrations." It was the third balcony appearance for the monarch during the jubilee weekend. She previously watched a flypast with her family and took a salute from soldiers as they returned from the Trooping the Colour military parade on Thursday. She also took part in the beacon lighting ceremony that evening from Windsor Castle. During the brief, three-minute appearance, the Queen looked on stoically as her family joined the public in a rendition of the National Anthem, performed by the Band of the Royal Marines. As red, white and blue flares were fired into the air, the family waved one last time and walked back into the residence as the West End cast of "Mamma Mia!" began singing "Dancing Queen." Moments before, British singer-songwriter Ed Sheeran took center stage in front of the palace gates, where he sang his hit song "Perfect." Archival footage of the Queen and Duke of Edinburgh played on the nearby big screens. Prince Harry and Meghan, Duchess of Sussex -- who have kept a low profile during their return to the UK for the festivities -- were not present at celebrations on Sunday. The Queen's disgraced son, Prince Andrew, was also absent after recently testing positive for coronavirus. The balcony appearance capped a spectacular jubilee grand finale on Sunday. Earlier, a cast of 6,000 people took to the streets of central London for The People's Pageant in her honor. Following a 3-kilometer (1.8-mile) route, military personnel, performers, key workers and volunteers from across the UK and Commonwealth marched, echoing the Queen's own coronation 70 years ago. The carnival procession paraded through the streets of Westminster, along the Mall and towards Buckingham Palace. Crowds hoping to see the Queen were given a clue the monarch had decided to make a surprise appearance as the Royal Standard flag was raised over the palace towards the end of the parade. CNN's James Frater contributed to this report.